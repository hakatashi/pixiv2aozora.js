/*!
 * pixiv2aozora - v0.4.0 - 2015-08-04
 * https://github.com/hakatashi/pixiv2aozora.js#readme
 * Copyright (c) 2015 Koki Takahashi
 * Licensed under MIT License
 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(){var b;b=window,b.pixiv2aozora=a("./")}).call(this)},{"./":2}],2:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n=[].slice,o={}.hasOwnProperty;d=a("pixiv-novel-parser").Parser,c={SOFTBREAK:10001},f={aozora:{"《":"※［＃始め二重山括弧、1-1-52］","》":"※［＃終わり二重山括弧、1-1-53］","［":"※［＃始め角括弧、1-1-46］","］":"※［＃終わり角括弧、1-1-47］","〔":"※［＃始めきっこう（亀甲）括弧、1-1-44］","〕":"※［＃終わりきっこう（亀甲）括弧、1-1-45］","｜":"※［＃縦線、1-1-35］","＃":"※［＃井げた、1-1-84］","※":"※［＃米印、1-2-8］"},publishing:{"《":"｜《","》":"｜》","［":"｜［","］":"｜］","〔":"〔","〕":"〕","｜":"｜｜","＃":"＃","※":"※"}},e=null,j=null,k=null,i=function(a){var b,c,d,e;switch(a.type){case void 0:for(b=[],c=0,d=a.length;d>c;c++)e=a[c],b.push.apply(b,i(e));break;case"tag":b=l[a.name](a);break;case"text":b=[g(a.val)]}return b},g=function(a){return a.replace(k,function(a){return e[a]})},l={newpage:function(){return[c.SOFTBREAK,"［＃改ページ］",c.SOFTBREAK]},chapter:function(a){return[c.SOFTBREAK,"［＃大見出し］"].concat(n.call(i(a.title)),["［＃大見出し終わり］"],[c.SOFTBREAK])},rb:function(a){return["｜",g(a.rubyBase),"《",g(a.rubyText),"》"]},pixivimage:function(){return[]},jumpuri:function(a){return i(a.title)},jump:function(a){return[a.pageNumber+"ページヘ"]}},m=function(a){var b,d,e,f,g;for(g=i(a),g[0]===c.SOFTBREAK&&g.shift(),g[g.length-1]===c.SOFTBREAK&&g.pop(),b=d=0,e=g.length;e>d;b=++d)f=g[b],f===c.SOFTBREAK&&(g[b]="\n");return g.join("")},h=function(a,b){var c,g,h,i;if(null==b&&(b={}),"object"!=typeof b)throw new Error("Invalid options");if(null==b.entities&&(b.entities="aozora"),"string"==typeof b.entities){if(null==f[b.entities])throw new Error("Unknown entity presets "+b.entities);e=f[b.entities]}else{if("object"!=typeof b.entities)throw new Error("Invalid option for entity presets");e=b.entities}return j=function(){var a;a=[];for(g in e)o.call(e,g)&&(h=e[g],a.push(g));return a}().join(""),k=new RegExp("["+j+"]","g"),i=new d,i.parse(a),c=i.tree,m(c)},b.exports=h}).call(this)},{"pixiv-novel-parser":3}],3:[function(a,b,c){!function(){"use strict";function c(a){a=a||{},this.syntax=a.syntax||"basic",this.tree=[]}var d,e;d=a("./parser.peg.js"),e=a("./parser-extended.peg.js"),c.parse=function(a,b){b=b||{},b.syntax=b.syntax||"basic";try{switch(a=a.replace(/\r?\n/g,"\n").replace(/[\s\u200c]/g,function(a){return"\n"===a||"　"===a?a:" "}),b.syntax){case"extended":return e.parse(a);case"basic":default:return d.parse(a)}}catch(c){return console.error(c),[{type:"text",val:a}]}},c.prototype.parse=function(a){return this.tree=c.parse(a,{syntax:this.syntax}),this},c.prototype.toJSON=function(){return JSON.stringify(this.tree)},b.exports={Parser:c}}()},{"./parser-extended.peg.js":4,"./parser.peg.js":5}],4:[function(a,b,c){!function(){var a=function(){var a={parse:function(a,b){function c(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function d(a){var b=a.charCodeAt(0);if(255>=b)var d="x",e=2;else var d="u",e=4;return"\\"+d+c(b.toString(16).toUpperCase(),"0",e)}function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,d)+'"'}function f(a){ka>ia||(ia>ka&&(ka=ia,la=[]),la.push(a))}function g(){var a="novel@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=[],d=o();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}for(;null!==e;){c.push(e);var d=o();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}}return ma[a]={nextPos:ia,result:c},c}function h(){var b="text@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia;if(null!==a.substr(ia).match(/^[^[\r\n]/)){var e=a.charAt(ia);ia++}else{var e=null;ja&&f("[^[\\r\\n]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ia).match(/^[^[\r\n]/)){var e=a.charAt(ia);ia++}else{var e=null;ja&&f("[^[\\r\\n]")}else var g=null;if(null!==g)var h=g;else{var i=ia,j=ia,k=ja;ja=!1;var l=ia,m=ja;ja=!1;var n=o();if(ja=m,null===n)var r="";else{var r=null;ia=l}if(ja=k,null!==r){var s="";ia=j}else var s=null;if(null!==s){if("["===a.substr(ia,1)){var t="[";ia+=1}else{var t=null;ja&&f('"["')}if(null!==t)var u=[s,t];else{var u=null;ia=i}}else{var u=null;ia=i}if(null!==u)var h=u;else{var v=ia,w=ia,x=ja;ja=!1;var y=ia,z=ja;ja=!1;var A=p();if(null!==A)var B=A;else{var C=q();if(null!==C)var B=C;else var B=null}if(ja=z,null===B)var D="";else{var D=null;ia=y}if(ja=x,null!==D){var E="";ia=w}else var E=null;if(null!==E){var G=F();if(null!==G)var H=[E,G];else{var H=null;ia=v}}else{var H=null;ia=v}if(null!==H)var h=H;else var h=null}}if(null!==h)for(var I=[];null!==h;){if(I.push(h),null!==a.substr(ia).match(/^[^[\r\n]/)){var e=a.charAt(ia);ia++}else{var e=null;ja&&f("[^[\\r\\n]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ia).match(/^[^[\r\n]/)){var e=a.charAt(ia);ia++}else{var e=null;ja&&f("[^[\\r\\n]")}else var g=null;if(null!==g)var h=g;else{var i=ia,j=ia,k=ja;ja=!1;var l=ia,m=ja;ja=!1;var n=o();if(ja=m,null===n)var r="";else{var r=null;ia=l}if(ja=k,null!==r){var s="";ia=j}else var s=null;if(null!==s){if("["===a.substr(ia,1)){var t="[";ia+=1}else{var t=null;ja&&f('"["')}if(null!==t)var u=[s,t];else{var u=null;ia=i}}else{var u=null;ia=i}if(null!==u)var h=u;else{var v=ia,w=ia,x=ja;ja=!1;var y=ia,z=ja;ja=!1;var A=p();if(null!==A)var B=A;else{var C=q();if(null!==C)var B=C;else var B=null}if(ja=z,null===B)var D="";else{var D=null;ia=y}if(ja=x,null!==D){var E="";ia=w}else var E=null;if(null!==E){var G=F();if(null!==G)var H=[E,G];else{var H=null;ia=v}}else{var H=null;ia=v}if(null!==H)var h=H;else var h=null}}}else var I=null;var J=null!==I?function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].join("");return $(b)}(I):null;if(null!==J)var K=J;else{var K=null;ia=d}return ma[b]={nextPos:ia,result:K},K}function i(){var b="inlineText@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia;if(null!==a.substr(ia).match(/^[^[\]]/)){var e=a.charAt(ia);ia++}else{var e=null;ja&&f("[^[\\]]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ia).match(/^[^[\]]/)){var e=a.charAt(ia);ia++}else{var e=null;ja&&f("[^[\\]]")}else var g=null;if(null!==g)var h=g;else{var i=ia,j=ia,k=ja;ja=!1;var l=ia,m=ja;ja=!1;var n=B();if(ja=m,null===n)var o="";else{var o=null;ia=l}if(ja=k,null!==o){var p="";ia=j}else var p=null;if(null!==p){if("["===a.substr(ia,1)){var q="[";ia+=1}else{var q=null;ja&&f('"["')}if(null!==q)var r=[p,q];else{var r=null;ia=i}}else{var r=null;ia=i}if(null!==r)var h=r;else var h=null}if(null!==h)for(var s=[];null!==h;){if(s.push(h),null!==a.substr(ia).match(/^[^[\]]/)){var e=a.charAt(ia);ia++}else{var e=null;ja&&f("[^[\\]]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(ia).match(/^[^[\]]/)){var e=a.charAt(ia);ia++}else{var e=null;ja&&f("[^[\\]]")}else var g=null;if(null!==g)var h=g;else{var i=ia,j=ia,k=ja;ja=!1;var l=ia,m=ja;ja=!1;var n=B();if(ja=m,null===n)var o="";else{var o=null;ia=l}if(ja=k,null!==o){var p="";ia=j}else var p=null;if(null!==p){if("["===a.substr(ia,1)){var q="[";ia+=1}else{var q=null;ja&&f('"["')}if(null!==q)var r=[p,q];else{var r=null;ia=i}}else{var r=null;ia=i}if(null!==r)var h=r;else var h=null}}else var s=null;var t=null!==s?function(a){return $(Z(Y(a).join("")))}(s):null;if(null!==t)var u=t;else{var u=null;ia=d}return ma[b]={nextPos:ia,result:u},u}function j(){var a="inlineToken@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=B();if(null!==c)var d=c;else{var e=i();if(null!==e)var d=e;else var d=null}return ma[a]={nextPos:ia,result:d},d}function k(){var a="inlineTokens@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=j();if(null!==c)for(var d=[];null!==c;){d.push(c);var c=j()}else var d=null;return ma[a]={nextPos:ia,result:d},d}function l(){var b="inlineInlineText@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia;if(null!==a.substr(ia).match(/^[^[>]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[^[>]")}if(null!==g)for(var h=[];null!==g;)if(h.push(g),null!==a.substr(ia).match(/^[^[>]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[^[>]")}else var h=null;if(null!==h){var i=ia,j=ja;ja=!1;var k=ia,l=ja;if(ja=!1,"]]"===a.substr(ia,2)){var m="]]";ia+=2}else{var m=null;ja&&f('"]]"')}if(ja=l,null===m)var n="";else{var n=null;ia=k}if(ja=j,null!==n){var o="";ia=i}else var o=null;if(null!==o)var p=[h,o];else{var p=null;ia=e}}else{var p=null;ia=e}if(null!==p)var q=p;else{var r=ia,s=ia,t=ja;ja=!1;var u=ia,v=ja;ja=!1;var w=B();if(ja=v,null===w)var x="";else{var x=null;ia=u}if(ja=t,null!==x){var y="";ia=s}else var y=null;if(null!==y){if("["===a.substr(ia,1)){var z="[";ia+=1}else{var z=null;ja&&f('"["')}if(null!==z)var A=[y,z];else{var A=null;ia=r}}else{var A=null;ia=r}if(null!==A)var q=A;else var q=null}if(null!==q)for(var C=[];null!==q;){C.push(q);var e=ia;if(null!==a.substr(ia).match(/^[^[>]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[^[>]")}if(null!==g)for(var h=[];null!==g;)if(h.push(g),null!==a.substr(ia).match(/^[^[>]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[^[>]")}else var h=null;if(null!==h){var i=ia,j=ja;ja=!1;var k=ia,l=ja;if(ja=!1,"]]"===a.substr(ia,2)){var m="]]";ia+=2}else{var m=null;ja&&f('"]]"')}if(ja=l,null===m)var n="";else{var n=null;ia=k}if(ja=j,null!==n){var o="";ia=i}else var o=null;if(null!==o)var p=[h,o];else{var p=null;ia=e}}else{var p=null;ia=e}if(null!==p)var q=p;else{var r=ia,s=ia,t=ja;ja=!1;var u=ia,v=ja;ja=!1;var w=B();if(ja=v,null===w)var x="";else{var x=null;ia=u}if(ja=t,null!==x){var y="";ia=s}else var y=null;if(null!==y){if("["===a.substr(ia,1)){var z="[";ia+=1}else{var z=null;ja&&f('"["')}if(null!==z)var A=[y,z];else{var A=null;ia=r}}else{var A=null;ia=r}if(null!==A)var q=A;else var q=null}}else var C=null;var D=null!==C?function(a){return $(Z(Y(a).join("")))}(C):null;if(null!==D)var E=D;else{var E=null;ia=d}return ma[b]={nextPos:ia,result:E},E}function m(){var a="inlineInlineToken@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=B();if(null!==c)var d=c;else{var e=l();if(null!==e)var d=e;else var d=null}return ma[a]={nextPos:ia,result:d},d}function n(){var a="inlineInlineTokens@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=m();if(null!==c)for(var d=[];null!==c;){d.push(c);var c=m()}else var d=null;return ma[a]={nextPos:ia,result:d},d}function o(){var a="tag@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=p();if(null!==c)var d=c;else{var e=q();if(null!==e)var d=e;else{var f=r();if(null!==f)var d=f;else{var g=s();if(null!==g)var d=g;else{var h=t();if(null!==h)var d=h;else{var i=B();if(null!==i)var d=i;else{var j=C();if(null!==j)var d=j;else{var k=D();if(null!==k)var d=k;else var d=null}}}}}}}return ma[a]={nextPos:ia,result:d},d}function p(){var b="tagNewpage@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia,g=F(),h=null!==g?g:"";if(null!==h){if("[newpage]"===a.substr(ia,9)){var i="[newpage]";ia+=9}else{var i=null;ja&&f('"[newpage]"')}if(null!==i){var j=F(),k=null!==j?j:"";if(null!==k)var l=[h,i,k];else{var l=null;ia=e}}else{var l=null;ia=e}}else{var l=null;ia=e}var m=null!==l?function(){return _()}():null;if(null!==m)var n=m;else{var n=null;ia=d}return ma[b]={nextPos:ia,result:n},n}function q(){var b="tagChapter@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia,g=F(),h=null!==g?g:"";if(null!==h){if("[chapter:"===a.substr(ia,9)){var i="[chapter:";ia+=9}else{var i=null;ja&&f('"[chapter:"')}if(null!==i){var j=k();if(null!==j){if("]"===a.substr(ia,1)){var l="]";ia+=1}else{var l=null;ja&&f('"]"')}if(null!==l){var m=F(),n=null!==m?m:"";if(null!==n)var o=[h,i,j,l,n];else{var o=null;ia=e}}else{var o=null;ia=e}}else{var o=null;ia=e}}else{var o=null;ia=e}}else{var o=null;ia=e}var p=null!==o?function(a){return aa(a)}(o[2]):null;if(null!==p)var q=p;else{var q=null;ia=d}return ma[b]={nextPos:ia,result:q},q}function r(){var b="tagPixivimage@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia;if("[pixivimage:"===a.substr(ia,12)){var g="[pixivimage:";ia+=12}else{var g=null;ja&&f('"[pixivimage:"')}if(null!==g){var h=w();if(null!==h){var i=ia;if("-"===a.substr(ia,1)){var j="-";ia+=1}else{var j=null;ja&&f('"-"')}if(null!==j){var k=x();if(null!==k)var l=[j,k];else{var l=null;ia=i}}else{var l=null;ia=i}var m=null!==l?l:"";if(null!==m){if("]"===a.substr(ia,1)){var n="]";ia+=1}else{var n=null;ja&&f('"]"')}if(null!==n)var o=[g,h,m,n];else{var o=null;ia=e}}else{var o=null;ia=e}}else{var o=null;ia=e}}else{var o=null;ia=e}var p=null!==o?function(a,b){return ba(a,b&&b[1])}(o[1],o[2]):null;if(null!==p)var q=p;else{var q=null;ia=d}return ma[b]={nextPos:ia,result:q},q}function s(){var b="tagJump@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia;if("[jump:"===a.substr(ia,6)){var g="[jump:";ia+=6}else{var g=null;ja&&f('"[jump:"')}if(null!==g){var h=x();if(null!==h){if("]"===a.substr(ia,1)){var i="]";ia+=1}else{var i=null;ja&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;ia=e}}else{var j=null;ia=e}}else{var j=null;ia=e}var k=null!==j?function(a){return ca(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;ia=d}return ma[b]={nextPos:ia,result:l},l}function t(){var b="tagJumpuri@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia;if("[[jumpuri:"===a.substr(ia,10)){var g="[[jumpuri:";ia+=10}else{var g=null;ja&&f('"[[jumpuri:"')}if(null!==g){var h=n();if(null!==h){if(">"===a.substr(ia,1)){var i=">";ia+=1}else{var i=null;ja&&f('">"')}if(null!==i){for(var j=[],k=V();null!==k;){j.push(k);var k=V()}if(null!==j){var l=y();if(null!==l){for(var m=[],o=V();null!==o;){m.push(o);var o=V()}if(null!==m){if("]]"===a.substr(ia,2)){var p="]]";ia+=2}else{var p=null;ja&&f('"]]"')}if(null!==p)var q=[g,h,i,j,l,m,p];else{var q=null;ia=e}}else{var q=null;ia=e}}else{var q=null;ia=e}}else{var q=null;ia=e}}else{var q=null;ia=e}}else{var q=null;ia=e}}else{var q=null;ia=e}var r=null!==q?function(a,b){return da(a,b)}(q[1],q[4]):null;if(null!==r)var s=r;else{var s=null;ia=d}return ma[b]={nextPos:ia,result:s},s}function u(){var b="chapterTitle@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=[];if(null!==a.substr(ia).match(/^[^\]]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[^\\]]")}for(;null!==g;)if(e.push(g),null!==a.substr(ia).match(/^[^\]]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[^\\]]")}var h=null!==e?function(a){return Z(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;ia=d}return ma[b]={nextPos:ia,result:i},i}function v(){var b="jumpuriTitle@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=[];if(null!==a.substr(ia).match(/^[^>]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[^>]")}for(;null!==g;)if(e.push(g),null!==a.substr(ia).match(/^[^>]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[^>]")}var h=null!==e?function(a){return Z(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;ia=d}return ma[b]={nextPos:ia,result:i},i}function w(){var a="numeric@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=ia,d=M();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=M()}else var e=null;var f=null!==e?function(a){return a.join("")}(e):null;if(null!==f)var g=f;else{var g=null;ia=c}return ma[a]={nextPos:ia,result:g},g}function x(){var a="integer@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=ia,d=M();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=M()}else var e=null;var f=null!==e?function(a){return parseInt(a.join(""),10)}(e):null;if(null!==f)var g=f;else{var g=null;ia=c}return ma[a]={nextPos:ia,result:g},g}function y(){var b="URI@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia,g=ia;if("http"===a.substr(ia,4)){var h="http";ia+=4}else{var h=null;ja&&f('"http"')}if(null!==h){if("s"===a.substr(ia,1)){var i="s";ia+=1}else{var i=null;ja&&f('"s"')}var j=null!==i?i:"";if(null!==j){if("://"===a.substr(ia,3)){var k="://";ia+=3}else{var k=null;ja&&f('"://"')}if(null!==k)var l=[h,j,k];else{var l=null;ia=g}}else{var l=null;ia=g}}else{var l=null;ia=g}if(null!==l){for(var m=[],n=z();null!==n;){m.push(n);var n=z()}if(null!==m)var o=[l,m];else{var o=null;ia=e}}else{var o=null;ia=e}var p=null!==o?function(a,b){return a.join("")+b.join("")}(o[0],o[1]):null;if(null!==p)var q=p;else{var q=null;ia=d}return ma[b]={nextPos:ia,result:q},q}function z(){var b="uri_chrs@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=G();if(null!==d)var e=d;else{var g=M();if(null!==g)var e=g;else{var h=A();if(null!==h)var e=h;else{if(null!==a.substr(ia).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var i=a.charAt(ia);ia++}else{var i=null;ja&&f("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==i)var e=i;else var e=null}}}return ma[b]={nextPos:ia,result:e},e}function A(){var b="percent_token@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia;if("%"===a.substr(ia,1)){var g="%";ia+=1}else{var g=null;ja&&f('"%"')}if(null!==g){var h=O();if(null!==h)for(var i=[];null!==h;){i.push(h);var h=O()}else var i=null;if(null!==i)var j=[g,i];else{var j=null;ia=e}}else{var j=null;ia=e}var k=null!==j?function(a){return"%"+a.join("")}(j[1]):null;if(null!==k)var l=k;else{var l=null;ia=d}return ma[b]={nextPos:ia,result:l},l}function B(){var b="tagRuby@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia;if("[[rb:"===a.substr(ia,5)){var g="[[rb:";ia+=5}else{var g=null;ja&&f('"[[rb:"')}if(null!==g){var h=[];if(null!==a.substr(ia).match(/^[^>]/)){var i=a.charAt(ia);ia++}else{var i=null;ja&&f("[^>]")}for(;null!==i;)if(h.push(i),null!==a.substr(ia).match(/^[^>]/)){var i=a.charAt(ia);ia++}else{var i=null;ja&&f("[^>]")}if(null!==h){if(">"===a.substr(ia,1)){var j=">";ia+=1}else{var j=null;ja&&f('">"')}if(null!==j){var k=[];if(null!==a.substr(ia).match(/^[^\]]/)){var l=a.charAt(ia);ia++}else{var l=null;ja&&f("[^\\]]")}if(null!==l)for(var m=[];null!==l;)if(m.push(l),null!==a.substr(ia).match(/^[^\]]/)){var l=a.charAt(ia);ia++}else{var l=null;ja&&f("[^\\]]")}else var m=null;if(null!==m)var n=m;else{var o=ia;if("]"===a.substr(ia,1)){var p="]";ia+=1}else{var p=null;ja&&f('"]"')}if(null!==p){var q=ia,r=ja;ja=!1;var s=ia,t=ja;if(ja=!1,"]"===a.substr(ia,1)){var u="]";ia+=1}else{var u=null;ja&&f('"]"')}if(ja=t,null===u)var v="";else{var v=null;ia=s}if(ja=r,null!==v){var w="";ia=q}else var w=null;if(null!==w)var x=[p,w];else{var x=null;ia=o}}else{var x=null;ia=o}if(null!==x)var n=x;else var n=null}for(;null!==n;){if(k.push(n),null!==a.substr(ia).match(/^[^\]]/)){var l=a.charAt(ia);ia++}else{var l=null;ja&&f("[^\\]]")}if(null!==l)for(var m=[];null!==l;)if(m.push(l),null!==a.substr(ia).match(/^[^\]]/)){var l=a.charAt(ia);ia++}else{var l=null;ja&&f("[^\\]]")}else var m=null;if(null!==m)var n=m;else{var o=ia;if("]"===a.substr(ia,1)){var p="]";ia+=1}else{var p=null;ja&&f('"]"')}if(null!==p){var q=ia,r=ja;ja=!1;var s=ia,t=ja;if(ja=!1,"]"===a.substr(ia,1)){var u="]";ia+=1}else{var u=null;ja&&f('"]"')}if(ja=t,null===u)var v="";else{var v=null;ia=s}if(ja=r,null!==v){var w="";ia=q}else var w=null;if(null!==w)var x=[p,w];else{var x=null;ia=o}}else{var x=null;ia=o}if(null!==x)var n=x;else var n=null}}if(null!==k){if("]]"===a.substr(ia,2)){var y="]]";ia+=2}else{var y=null;ja&&f('"]]"')}if(null!==y)var z=[g,h,j,k,y];else{var z=null;ia=e}}else{var z=null;ia=e}}else{var z=null;ia=e}}else{var z=null;ia=e}}else{var z=null;ia=e}var A=null!==z?function(a,b){return ea(Z(a.join("")),Z(Y(b).join("")))}(z[1],z[3]):null;if(null!==A)var B=A;else{var B=null;ia=d}return ma[b]={nextPos:ia,result:B},B}function C(){var b="tagEmoji@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia;if("[emoji:"===a.substr(ia,7)){var g="[emoji:";ia+=7}else{var g=null;ja&&f('"[emoji:"')}if(null!==g){var h=E();if(null!==h){if("]"===a.substr(ia,1)){var i="]";ia+=1}else{var i=null;ja&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;ia=e}}else{var j=null;ia=e}}else{var j=null;ia=e}var k=null!==j?function(a){return fa(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;ia=d}return ma[b]={nextPos:ia,result:l},l}function D(){var b="tagStrong@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=ia;if("[strong:"===a.substr(ia,8)){var g="[strong:";ia+=8}else{var g=null;ja&&f('"[strong:"')}if(null!==g){var h=[];if(null!==a.substr(ia).match(/^[^\]]/)){var i=a.charAt(ia);ia++}else{var i=null;ja&&f("[^\\]]")}for(;null!==i;)if(h.push(i),null!==a.substr(ia).match(/^[^\]]/)){var i=a.charAt(ia);ia++}else{var i=null;ja&&f("[^\\]]")}if(null!==h){if("]"===a.substr(ia,1)){var j="]";ia+=1}else{var j=null;ja&&f('"]"')}if(null!==j)var k=[g,h,j];else{var k=null;ia=e}}else{var k=null;ia=e}}else{var k=null;ia=e}var l=null!==k?function(a){return ga(Z(a.join("")))}(k[1]):null;if(null!==l)var m=l;else{var m=null;ia=d}return ma[b]={nextPos:ia,result:m},m}function E(){var b="emojiName@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=ia,e=G();if(null!==e)var g=e;else{var h=M();if(null!==h)var g=h;else{if("-"===a.substr(ia,1)){var i="-";ia+=1}else{var i=null;ja&&f('"-"')}if(null!==i)var g=i;else var g=null}}if(null!==g)for(var j=[];null!==g;){j.push(g);var e=G();if(null!==e)var g=e;else{var h=M();if(null!==h)var g=h;else{if("-"===a.substr(ia,1)){var i="-";ia+=1}else{var i=null;ja&&f('"-"')}if(null!==i)var g=i;else var g=null}}}else var j=null;var k=null!==j?function(a){return Z(a.join(""))}(j):null;if(null!==k)var l=k;else{var l=null;ia=d}return ma[b]={nextPos:ia,result:l},l}function F(){var a="newLine@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=Q();if(null!==c)var d=c;else{var e=ia,f=J();if(null!==f){var g=Q(),h=null!==g?g:"";if(null!==h)var i=[f,h];else{var i=null;ia=e}}else{var i=null;ia=e}if(null!==i)var d=i;else var d=null}return ma[a]={nextPos:ia,result:d},d}function G(){var b="ALPHA@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if(null!==a.substr(ia).match(/^[A-Z]/)){var d=a.charAt(ia);ia++}else{var d=null;ja&&f("[A-Z]")}if(null!==d)var e=d;else{if(null!==a.substr(ia).match(/^[a-z]/)){var g=a.charAt(ia);ia++}else{var g=null;ja&&f("[a-z]")}if(null!==g)var e=g;else var e=null}return ma[b]={nextPos:ia,result:e},e}function H(){var b="BIT@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if("0"===a.substr(ia,1)){var d="0";ia+=1}else{var d=null;ja&&f('"0"')}if(null!==d)var e=d;else{if("1"===a.substr(ia,1)){var g="1";ia+=1}else{var g=null;ja&&f('"1"')}if(null!==g)var e=g;else var e=null}return ma[b]={nextPos:ia,result:e},e}function I(){var b="CHAR@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if(null!==a.substr(ia).match(/^[-]/)){var d=a.charAt(ia);ia++}else{var d=null;ja&&f("[-]")}return ma[b]={nextPos:ia,result:d},d}function J(){var b="CR@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if("\r"===a.substr(ia,1)){var d="\r";ia+=1}else{var d=null;ja&&f('"\\r"')}return ma[b]={nextPos:ia,result:d},d}function K(){var a="CRLF@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=ia,d=J();if(null!==d){var e=Q();if(null!==e)var f=[d,e];else{var f=null;ia=c}}else{var f=null;ia=c}return ma[a]={nextPos:ia,result:f},f}function L(){var b="CTL@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if(null!==a.substr(ia).match(/^[\0-]/)){var d=a.charAt(ia);ia++}else{var d=null;ja&&f("[\\0-]")}if(null!==d)var e=d;else{if(""===a.substr(ia,1)){var g="";ia+=1}else{var g=null;ja&&f('""')}if(null!==g)var e=g;else var e=null}return ma[b]={nextPos:ia,result:e},e}function M(){var b="DIGIT@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if(null!==a.substr(ia).match(/^[0-9]/)){var d=a.charAt(ia);ia++}else{var d=null;ja&&f("[0-9]")}return ma[b]={nextPos:ia,result:d},d}function N(){var b="DQUOTE@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if(null!==a.substr(ia).match(/^["]/)){var d=a.charAt(ia);ia++}else{var d=null;ja&&f('["]')}return ma[b]={nextPos:ia,result:d},d}function O(){var b="HEXDIG@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;var d=M();if(null!==d)var e=d;else{if("A"===a.substr(ia,1)){var g="A";ia+=1}else{var g=null;ja&&f('"A"')}if(null!==g)var e=g;else{if("B"===a.substr(ia,1)){var h="B";ia+=1}else{var h=null;ja&&f('"B"')}if(null!==h)var e=h;else{if("C"===a.substr(ia,1)){var i="C";ia+=1}else{var i=null;ja&&f('"C"')}if(null!==i)var e=i;else{if("D"===a.substr(ia,1)){var j="D";ia+=1}else{var j=null;ja&&f('"D"')}if(null!==j)var e=j;else{if("E"===a.substr(ia,1)){var k="E";ia+=1}else{var k=null;ja&&f('"E"')}if(null!==k)var e=k;else{if("F"===a.substr(ia,1)){var l="F";ia+=1}else{var l=null;ja&&f('"F"')}if(null!==l)var e=l;else var e=null}}}}}}return ma[b]={nextPos:ia,result:e},e}function P(){var b="HTAB@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if("	"===a.substr(ia,1)){var d="	";ia+=1}else{var d=null;ja&&f('"	"')}return ma[b]={nextPos:ia,result:d},d}function Q(){var b="LF@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if("\n"===a.substr(ia,1)){var d="\n";ia+=1}else{var d=null;ja&&f('"\\n"')}return ma[b]={nextPos:ia,result:d},d}function R(){var a="LWSP@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=[],d=V();if(null!==d)var e=d;else{var f=ia,g=K();if(null!==g){var h=V();if(null!==h)var i=[g,h];else{var i=null;ia=f}}else{var i=null;ia=f}if(null!==i)var e=i;else var e=null}for(;null!==e;){c.push(e);var d=V();if(null!==d)var e=d;else{var f=ia,g=K();if(null!==g){var h=V();if(null!==h)var i=[g,h];else{var i=null;ia=f}}else{var i=null;ia=f}if(null!==i)var e=i;else var e=null}}return ma[a]={nextPos:ia,result:c},c}function S(){var b="OCTET@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if(null!==a.substr(ia).match(/^[\0-\xFF]/)){var d=a.charAt(ia);ia++}else{var d=null;ja&&f("[\\0-\\xFF]")}return ma[b]={nextPos:ia,result:d},d}function T(){var b="SP@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if(" "===a.substr(ia,1)){var d=" ";ia+=1}else{var d=null;ja&&f('" "')}return ma[b]={nextPos:ia,result:d},d}function U(){var b="VCHAR@"+ia,c=ma[b];if(c)return ia=c.nextPos,c.result;if(null!==a.substr(ia).match(/^[!-~]/)){var d=a.charAt(ia);ia++}else{var d=null;ja&&f("[!-~]")}return ma[b]={nextPos:ia,result:d},d}function V(){var a="WSP@"+ia,b=ma[a];if(b)return ia=b.nextPos,b.result;var c=T();if(null!==c)var d=c;else{var e=P();if(null!==e)var d=e;else var d=null}return ma[a]={nextPos:ia,result:d},d}function W(){function b(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(la),d=Math.max(ia,ka),f=d<a.length?e(a.charAt(d)):"end of input";return"Expected "+c+" but "+f+" found."}function X(){for(var b=1,c=1,d=!1,e=0;ka>e;e++){var f=a.charAt(e);"\n"===f?(d||b++,c=1,d=!1):"\r"===f|"\u2028"===f||"\u2029"===f?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}function Y(a){for(var b=[],c=0;c<a.length;c++)"object"==typeof a[c]?b=b.concat(Y(a[c])):b.push(a[c]);return b}function Z(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function $(a){return{type:"text",val:a}}function _(){return{type:"tag",name:"newpage"}}function aa(a){return{type:"tag",name:"chapter",title:a}}function ba(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function ca(a){return{type:"tag",name:"jump",pageNumber:a}}function da(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}function ea(a,b){return{type:"tag",name:"rb",rubyBase:a,rubyText:b}}function fa(a){return{type:"tag",name:"emoji",emojiName:a}}function ga(a){return{type:"tag",name:"strong",val:a}}var ha={ALPHA:G,BIT:H,CHAR:I,CR:J,CRLF:K,CTL:L,DIGIT:M,DQUOTE:N,HEXDIG:O,HTAB:P,LF:Q,LWSP:R,OCTET:S,SP:T,URI:y,VCHAR:U,WSP:V,chapterTitle:u,emojiName:E,inlineInlineText:l,inlineInlineToken:m,inlineInlineTokens:n,inlineText:i,inlineToken:j,inlineTokens:k,integer:x,jumpuriTitle:v,newLine:F,novel:g,numeric:w,percent_token:A,tag:o,tagChapter:q,tagEmoji:C,tagJump:s,tagJumpuri:t,tagNewpage:p,tagPixivimage:r,tagRuby:B,tagStrong:D,text:h,uri_chrs:z};if(void 0!==b){if(void 0===ha[b])throw new Error("Invalid rule name: "+e(b)+".")}else b="novel";var ia=0,ja=!0,ka=0,la=[],ma={},na=ha[b]();if(null===na||ia!==a.length){var oa=X();throw new this.SyntaxError(W(),oa.line,oa.column)}return na},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}();b.exports=a}()},{}],5:[function(a,b,c){!function(){var a=function(){var a={parse:function(a,b){function c(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function d(a){var b=a.charCodeAt(0);if(255>=b)var d="x",e=2;else var d="u",e=4;return"\\"+d+c(b.toString(16).toUpperCase(),"0",e)}function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,d)+'"'}function f(a){fa>da||(da>fa&&(fa=da,ga=[]),ga.push(a))}function g(){var a="novel@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=[],d=o();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}for(;null!==e;){c.push(e);var d=o();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}}return ha[a]={nextPos:da,result:c},c}function h(){var b="text@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da;if(null!==a.substr(da).match(/^[^[\r\n]/)){var e=a.charAt(da);da++}else{var e=null;ea&&f("[^[\\r\\n]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(da).match(/^[^[\r\n]/)){var e=a.charAt(da);da++}else{var e=null;ea&&f("[^[\\r\\n]")}else var g=null;if(null!==g)var h=g;else{var i=da,j=da,k=ea;ea=!1;var l=da,m=ea;ea=!1;var n=o();if(ea=m,null===n)var r="";else{var r=null;da=l}if(ea=k,null!==r){var s="";da=j}else var s=null;if(null!==s){if("["===a.substr(da,1)){var t="[";da+=1}else{var t=null;ea&&f('"["')}if(null!==t)var u=[s,t];else{var u=null;da=i}}else{var u=null;da=i}if(null!==u)var h=u;else{var v=da,w=da,x=ea;ea=!1;var y=da,z=ea;ea=!1;var A=p();if(null!==A)var B=A;else{var D=q();if(null!==D)var B=D;else var B=null}if(ea=z,null===B)var E="";else{var E=null;da=y}if(ea=x,null!==E){var F="";da=w}else var F=null;if(null!==F){var G=C();if(null!==G)var H=[F,G];else{var H=null;da=v}}else{var H=null;da=v}if(null!==H)var h=H;else var h=null}}if(null!==h)for(var I=[];null!==h;){if(I.push(h),null!==a.substr(da).match(/^[^[\r\n]/)){var e=a.charAt(da);da++}else{var e=null;ea&&f("[^[\\r\\n]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(da).match(/^[^[\r\n]/)){var e=a.charAt(da);da++}else{var e=null;ea&&f("[^[\\r\\n]")}else var g=null;if(null!==g)var h=g;else{var i=da,j=da,k=ea;ea=!1;var l=da,m=ea;ea=!1;var n=o();if(ea=m,null===n)var r="";else{var r=null;da=l}if(ea=k,null!==r){var s="";da=j}else var s=null;if(null!==s){if("["===a.substr(da,1)){var t="[";da+=1}else{var t=null;ea&&f('"["')}if(null!==t)var u=[s,t];else{var u=null;da=i}}else{var u=null;da=i}if(null!==u)var h=u;else{var v=da,w=da,x=ea;ea=!1;var y=da,z=ea;ea=!1;var A=p();if(null!==A)var B=A;else{var D=q();if(null!==D)var B=D;else var B=null}if(ea=z,null===B)var E="";else{var E=null;da=y}if(ea=x,null!==E){var F="";da=w}else var F=null;if(null!==F){var G=C();if(null!==G)var H=[F,G];else{var H=null;da=v}}else{var H=null;da=v}if(null!==H)var h=H;else var h=null}}}else var I=null;var J=null!==I?function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].join("");return X(b)}(I):null;if(null!==J)var K=J;else{var K=null;da=d}return ha[b]={nextPos:da,result:K},K}function i(){var b="inlineText@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da;if(null!==a.substr(da).match(/^[^[\]]/)){var e=a.charAt(da);da++}else{var e=null;ea&&f("[^[\\]]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(da).match(/^[^[\]]/)){var e=a.charAt(da);da++}else{var e=null;ea&&f("[^[\\]]")}else var g=null;if(null!==g)var h=g;else{var i=da,j=da,k=ea;ea=!1;var l=da,m=ea;ea=!1;var n=B();if(ea=m,null===n)var o="";else{var o=null;da=l}if(ea=k,null!==o){var p="";da=j}else var p=null;if(null!==p){if("["===a.substr(da,1)){var q="[";da+=1}else{var q=null;ea&&f('"["')}if(null!==q)var r=[p,q];else{var r=null;da=i}}else{var r=null;da=i}if(null!==r)var h=r;else var h=null}if(null!==h)for(var s=[];null!==h;){
if(s.push(h),null!==a.substr(da).match(/^[^[\]]/)){var e=a.charAt(da);da++}else{var e=null;ea&&f("[^[\\]]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(da).match(/^[^[\]]/)){var e=a.charAt(da);da++}else{var e=null;ea&&f("[^[\\]]")}else var g=null;if(null!==g)var h=g;else{var i=da,j=da,k=ea;ea=!1;var l=da,m=ea;ea=!1;var n=B();if(ea=m,null===n)var o="";else{var o=null;da=l}if(ea=k,null!==o){var p="";da=j}else var p=null;if(null!==p){if("["===a.substr(da,1)){var q="[";da+=1}else{var q=null;ea&&f('"["')}if(null!==q)var r=[p,q];else{var r=null;da=i}}else{var r=null;da=i}if(null!==r)var h=r;else var h=null}}else var s=null;var t=null!==s?function(a){return X(W(V(a).join("")))}(s):null;if(null!==t)var u=t;else{var u=null;da=d}return ha[b]={nextPos:da,result:u},u}function j(){var a="inlineToken@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=B();if(null!==c)var d=c;else{var e=i();if(null!==e)var d=e;else var d=null}return ha[a]={nextPos:da,result:d},d}function k(){var a="inlineTokens@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=j();if(null!==c)for(var d=[];null!==c;){d.push(c);var c=j()}else var d=null;return ha[a]={nextPos:da,result:d},d}function l(){var b="inlineInlineText@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da;if(null!==a.substr(da).match(/^[^[>]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[^[>]")}if(null!==g)for(var h=[];null!==g;)if(h.push(g),null!==a.substr(da).match(/^[^[>]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[^[>]")}else var h=null;if(null!==h){var i=da,j=ea;ea=!1;var k=da,l=ea;if(ea=!1,"]]"===a.substr(da,2)){var m="]]";da+=2}else{var m=null;ea&&f('"]]"')}if(ea=l,null===m)var n="";else{var n=null;da=k}if(ea=j,null!==n){var o="";da=i}else var o=null;if(null!==o)var p=[h,o];else{var p=null;da=e}}else{var p=null;da=e}if(null!==p)var q=p;else{var r=da,s=da,t=ea;ea=!1;var u=da,v=ea;ea=!1;var w=B();if(ea=v,null===w)var x="";else{var x=null;da=u}if(ea=t,null!==x){var y="";da=s}else var y=null;if(null!==y){if("["===a.substr(da,1)){var z="[";da+=1}else{var z=null;ea&&f('"["')}if(null!==z)var A=[y,z];else{var A=null;da=r}}else{var A=null;da=r}if(null!==A)var q=A;else var q=null}if(null!==q)for(var C=[];null!==q;){C.push(q);var e=da;if(null!==a.substr(da).match(/^[^[>]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[^[>]")}if(null!==g)for(var h=[];null!==g;)if(h.push(g),null!==a.substr(da).match(/^[^[>]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[^[>]")}else var h=null;if(null!==h){var i=da,j=ea;ea=!1;var k=da,l=ea;if(ea=!1,"]]"===a.substr(da,2)){var m="]]";da+=2}else{var m=null;ea&&f('"]]"')}if(ea=l,null===m)var n="";else{var n=null;da=k}if(ea=j,null!==n){var o="";da=i}else var o=null;if(null!==o)var p=[h,o];else{var p=null;da=e}}else{var p=null;da=e}if(null!==p)var q=p;else{var r=da,s=da,t=ea;ea=!1;var u=da,v=ea;ea=!1;var w=B();if(ea=v,null===w)var x="";else{var x=null;da=u}if(ea=t,null!==x){var y="";da=s}else var y=null;if(null!==y){if("["===a.substr(da,1)){var z="[";da+=1}else{var z=null;ea&&f('"["')}if(null!==z)var A=[y,z];else{var A=null;da=r}}else{var A=null;da=r}if(null!==A)var q=A;else var q=null}}else var C=null;var D=null!==C?function(a){return X(W(V(a).join("")))}(C):null;if(null!==D)var E=D;else{var E=null;da=d}return ha[b]={nextPos:da,result:E},E}function m(){var a="inlineInlineToken@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=B();if(null!==c)var d=c;else{var e=l();if(null!==e)var d=e;else var d=null}return ha[a]={nextPos:da,result:d},d}function n(){var a="inlineInlineTokens@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=m();if(null!==c)for(var d=[];null!==c;){d.push(c);var c=m()}else var d=null;return ha[a]={nextPos:da,result:d},d}function o(){var a="tag@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=p();if(null!==c)var d=c;else{var e=q();if(null!==e)var d=e;else{var f=r();if(null!==f)var d=f;else{var g=s();if(null!==g)var d=g;else{var h=t();if(null!==h)var d=h;else{var i=B();if(null!==i)var d=i;else var d=null}}}}}return ha[a]={nextPos:da,result:d},d}function p(){var b="tagNewpage@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da,g=C(),h=null!==g?g:"";if(null!==h){if("[newpage]"===a.substr(da,9)){var i="[newpage]";da+=9}else{var i=null;ea&&f('"[newpage]"')}if(null!==i){var j=C(),k=null!==j?j:"";if(null!==k)var l=[h,i,k];else{var l=null;da=e}}else{var l=null;da=e}}else{var l=null;da=e}var m=null!==l?function(){return Y()}():null;if(null!==m)var n=m;else{var n=null;da=d}return ha[b]={nextPos:da,result:n},n}function q(){var b="tagChapter@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da,g=C(),h=null!==g?g:"";if(null!==h){if("[chapter:"===a.substr(da,9)){var i="[chapter:";da+=9}else{var i=null;ea&&f('"[chapter:"')}if(null!==i){var j=k();if(null!==j){if("]"===a.substr(da,1)){var l="]";da+=1}else{var l=null;ea&&f('"]"')}if(null!==l){var m=C(),n=null!==m?m:"";if(null!==n)var o=[h,i,j,l,n];else{var o=null;da=e}}else{var o=null;da=e}}else{var o=null;da=e}}else{var o=null;da=e}}else{var o=null;da=e}var p=null!==o?function(a){return Z(a)}(o[2]):null;if(null!==p)var q=p;else{var q=null;da=d}return ha[b]={nextPos:da,result:q},q}function r(){var b="tagPixivimage@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da;if("[pixivimage:"===a.substr(da,12)){var g="[pixivimage:";da+=12}else{var g=null;ea&&f('"[pixivimage:"')}if(null!==g){var h=w();if(null!==h){var i=da;if("-"===a.substr(da,1)){var j="-";da+=1}else{var j=null;ea&&f('"-"')}if(null!==j){var k=x();if(null!==k)var l=[j,k];else{var l=null;da=i}}else{var l=null;da=i}var m=null!==l?l:"";if(null!==m){if("]"===a.substr(da,1)){var n="]";da+=1}else{var n=null;ea&&f('"]"')}if(null!==n)var o=[g,h,m,n];else{var o=null;da=e}}else{var o=null;da=e}}else{var o=null;da=e}}else{var o=null;da=e}var p=null!==o?function(a,b){return $(a,b&&b[1])}(o[1],o[2]):null;if(null!==p)var q=p;else{var q=null;da=d}return ha[b]={nextPos:da,result:q},q}function s(){var b="tagJump@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da;if("[jump:"===a.substr(da,6)){var g="[jump:";da+=6}else{var g=null;ea&&f('"[jump:"')}if(null!==g){var h=x();if(null!==h){if("]"===a.substr(da,1)){var i="]";da+=1}else{var i=null;ea&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;da=e}}else{var j=null;da=e}}else{var j=null;da=e}var k=null!==j?function(a){return _(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;da=d}return ha[b]={nextPos:da,result:l},l}function t(){var b="tagJumpuri@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da;if("[[jumpuri:"===a.substr(da,10)){var g="[[jumpuri:";da+=10}else{var g=null;ea&&f('"[[jumpuri:"')}if(null!==g){var h=n();if(null!==h){if(">"===a.substr(da,1)){var i=">";da+=1}else{var i=null;ea&&f('">"')}if(null!==i){for(var j=[],k=S();null!==k;){j.push(k);var k=S()}if(null!==j){var l=y();if(null!==l){for(var m=[],o=S();null!==o;){m.push(o);var o=S()}if(null!==m){if("]]"===a.substr(da,2)){var p="]]";da+=2}else{var p=null;ea&&f('"]]"')}if(null!==p)var q=[g,h,i,j,l,m,p];else{var q=null;da=e}}else{var q=null;da=e}}else{var q=null;da=e}}else{var q=null;da=e}}else{var q=null;da=e}}else{var q=null;da=e}}else{var q=null;da=e}var r=null!==q?function(a,b){return aa(a,b)}(q[1],q[4]):null;if(null!==r)var s=r;else{var s=null;da=d}return ha[b]={nextPos:da,result:s},s}function u(){var b="chapterTitle@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=[];if(null!==a.substr(da).match(/^[^\]]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[^\\]]")}for(;null!==g;)if(e.push(g),null!==a.substr(da).match(/^[^\]]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[^\\]]")}var h=null!==e?function(a){return W(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;da=d}return ha[b]={nextPos:da,result:i},i}function v(){var b="jumpuriTitle@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=[];if(null!==a.substr(da).match(/^[^>]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[^>]")}for(;null!==g;)if(e.push(g),null!==a.substr(da).match(/^[^>]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[^>]")}var h=null!==e?function(a){return W(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;da=d}return ha[b]={nextPos:da,result:i},i}function w(){var a="numeric@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=da,d=J();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=J()}else var e=null;var f=null!==e?function(a){return a.join("")}(e):null;if(null!==f)var g=f;else{var g=null;da=c}return ha[a]={nextPos:da,result:g},g}function x(){var a="integer@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=da,d=J();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=J()}else var e=null;var f=null!==e?function(a){return parseInt(a.join(""),10)}(e):null;if(null!==f)var g=f;else{var g=null;da=c}return ha[a]={nextPos:da,result:g},g}function y(){var b="URI@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da,g=da;if("http"===a.substr(da,4)){var h="http";da+=4}else{var h=null;ea&&f('"http"')}if(null!==h){if("s"===a.substr(da,1)){var i="s";da+=1}else{var i=null;ea&&f('"s"')}var j=null!==i?i:"";if(null!==j){if("://"===a.substr(da,3)){var k="://";da+=3}else{var k=null;ea&&f('"://"')}if(null!==k)var l=[h,j,k];else{var l=null;da=g}}else{var l=null;da=g}}else{var l=null;da=g}if(null!==l){for(var m=[],n=z();null!==n;){m.push(n);var n=z()}if(null!==m)var o=[l,m];else{var o=null;da=e}}else{var o=null;da=e}var p=null!==o?function(a,b){return a.join("")+b.join("")}(o[0],o[1]):null;if(null!==p)var q=p;else{var q=null;da=d}return ha[b]={nextPos:da,result:q},q}function z(){var b="uri_chrs@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=D();if(null!==d)var e=d;else{var g=J();if(null!==g)var e=g;else{var h=A();if(null!==h)var e=h;else{if(null!==a.substr(da).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var i=a.charAt(da);da++}else{var i=null;ea&&f("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==i)var e=i;else var e=null}}}return ha[b]={nextPos:da,result:e},e}function A(){var b="percent_token@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da;if("%"===a.substr(da,1)){var g="%";da+=1}else{var g=null;ea&&f('"%"')}if(null!==g){var h=L();if(null!==h)for(var i=[];null!==h;){i.push(h);var h=L()}else var i=null;if(null!==i)var j=[g,i];else{var j=null;da=e}}else{var j=null;da=e}var k=null!==j?function(a){return"%"+a.join("")}(j[1]):null;if(null!==k)var l=k;else{var l=null;da=d}return ha[b]={nextPos:da,result:l},l}function B(){var b="tagRuby@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=da,e=da;if("[[rb:"===a.substr(da,5)){var g="[[rb:";da+=5}else{var g=null;ea&&f('"[[rb:"')}if(null!==g){var h=[];if(null!==a.substr(da).match(/^[^>]/)){var i=a.charAt(da);da++}else{var i=null;ea&&f("[^>]")}for(;null!==i;)if(h.push(i),null!==a.substr(da).match(/^[^>]/)){var i=a.charAt(da);da++}else{var i=null;ea&&f("[^>]")}if(null!==h){if(">"===a.substr(da,1)){var j=">";da+=1}else{var j=null;ea&&f('">"')}if(null!==j){var k=[];if(null!==a.substr(da).match(/^[^\]]/)){var l=a.charAt(da);da++}else{var l=null;ea&&f("[^\\]]")}if(null!==l)for(var m=[];null!==l;)if(m.push(l),null!==a.substr(da).match(/^[^\]]/)){var l=a.charAt(da);da++}else{var l=null;ea&&f("[^\\]]")}else var m=null;if(null!==m)var n=m;else{var o=da;if("]"===a.substr(da,1)){var p="]";da+=1}else{var p=null;ea&&f('"]"')}if(null!==p){var q=da,r=ea;ea=!1;var s=da,t=ea;if(ea=!1,"]"===a.substr(da,1)){var u="]";da+=1}else{var u=null;ea&&f('"]"')}if(ea=t,null===u)var v="";else{var v=null;da=s}if(ea=r,null!==v){var w="";da=q}else var w=null;if(null!==w)var x=[p,w];else{var x=null;da=o}}else{var x=null;da=o}if(null!==x)var n=x;else var n=null}for(;null!==n;){if(k.push(n),null!==a.substr(da).match(/^[^\]]/)){var l=a.charAt(da);da++}else{var l=null;ea&&f("[^\\]]")}if(null!==l)for(var m=[];null!==l;)if(m.push(l),null!==a.substr(da).match(/^[^\]]/)){var l=a.charAt(da);da++}else{var l=null;ea&&f("[^\\]]")}else var m=null;if(null!==m)var n=m;else{var o=da;if("]"===a.substr(da,1)){var p="]";da+=1}else{var p=null;ea&&f('"]"')}if(null!==p){var q=da,r=ea;ea=!1;var s=da,t=ea;if(ea=!1,"]"===a.substr(da,1)){var u="]";da+=1}else{var u=null;ea&&f('"]"')}if(ea=t,null===u)var v="";else{var v=null;da=s}if(ea=r,null!==v){var w="";da=q}else var w=null;if(null!==w)var x=[p,w];else{var x=null;da=o}}else{var x=null;da=o}if(null!==x)var n=x;else var n=null}}if(null!==k){if("]]"===a.substr(da,2)){var y="]]";da+=2}else{var y=null;ea&&f('"]]"')}if(null!==y)var z=[g,h,j,k,y];else{var z=null;da=e}}else{var z=null;da=e}}else{var z=null;da=e}}else{var z=null;da=e}}else{var z=null;da=e}var A=null!==z?function(a,b){return ba(W(a.join("")),W(V(b).join("")))}(z[1],z[3]):null;if(null!==A)var B=A;else{var B=null;da=d}return ha[b]={nextPos:da,result:B},B}function C(){var a="newLine@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=N();if(null!==c)var d=c;else{var e=da,f=G();if(null!==f){var g=N(),h=null!==g?g:"";if(null!==h)var i=[f,h];else{var i=null;da=e}}else{var i=null;da=e}if(null!==i)var d=i;else var d=null}return ha[a]={nextPos:da,result:d},d}function D(){var b="ALPHA@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if(null!==a.substr(da).match(/^[A-Z]/)){var d=a.charAt(da);da++}else{var d=null;ea&&f("[A-Z]")}if(null!==d)var e=d;else{if(null!==a.substr(da).match(/^[a-z]/)){var g=a.charAt(da);da++}else{var g=null;ea&&f("[a-z]")}if(null!==g)var e=g;else var e=null}return ha[b]={nextPos:da,result:e},e}function E(){var b="BIT@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if("0"===a.substr(da,1)){var d="0";da+=1}else{var d=null;ea&&f('"0"')}if(null!==d)var e=d;else{if("1"===a.substr(da,1)){var g="1";da+=1}else{var g=null;ea&&f('"1"')}if(null!==g)var e=g;else var e=null}return ha[b]={nextPos:da,result:e},e}function F(){var b="CHAR@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if(null!==a.substr(da).match(/^[-]/)){var d=a.charAt(da);da++}else{var d=null;ea&&f("[-]")}return ha[b]={nextPos:da,result:d},d}function G(){var b="CR@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if("\r"===a.substr(da,1)){var d="\r";da+=1}else{var d=null;ea&&f('"\\r"')}return ha[b]={nextPos:da,result:d},d}function H(){var a="CRLF@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=da,d=G();if(null!==d){var e=N();if(null!==e)var f=[d,e];else{var f=null;da=c}}else{var f=null;da=c}return ha[a]={nextPos:da,result:f},f}function I(){var b="CTL@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if(null!==a.substr(da).match(/^[\0-]/)){var d=a.charAt(da);da++}else{var d=null;ea&&f("[\\0-]")}if(null!==d)var e=d;else{if(""===a.substr(da,1)){var g="";da+=1}else{var g=null;ea&&f('""')}if(null!==g)var e=g;else var e=null}return ha[b]={nextPos:da,result:e},e}function J(){var b="DIGIT@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if(null!==a.substr(da).match(/^[0-9]/)){var d=a.charAt(da);da++}else{var d=null;ea&&f("[0-9]")}return ha[b]={nextPos:da,result:d},d}function K(){var b="DQUOTE@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if(null!==a.substr(da).match(/^["]/)){var d=a.charAt(da);da++}else{var d=null;ea&&f('["]')}return ha[b]={nextPos:da,result:d},d}function L(){var b="HEXDIG@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;var d=J();if(null!==d)var e=d;else{if("A"===a.substr(da,1)){var g="A";da+=1}else{var g=null;ea&&f('"A"')}if(null!==g)var e=g;else{if("B"===a.substr(da,1)){var h="B";da+=1}else{var h=null;ea&&f('"B"')}if(null!==h)var e=h;else{if("C"===a.substr(da,1)){var i="C";da+=1}else{var i=null;ea&&f('"C"')}if(null!==i)var e=i;else{if("D"===a.substr(da,1)){var j="D";da+=1}else{var j=null;ea&&f('"D"')}if(null!==j)var e=j;else{if("E"===a.substr(da,1)){var k="E";da+=1}else{var k=null;ea&&f('"E"')}if(null!==k)var e=k;else{if("F"===a.substr(da,1)){var l="F";da+=1}else{var l=null;ea&&f('"F"')}if(null!==l)var e=l;else var e=null}}}}}}return ha[b]={nextPos:da,result:e},e}function M(){var b="HTAB@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if("	"===a.substr(da,1)){var d="	";da+=1}else{var d=null;ea&&f('"	"')}return ha[b]={nextPos:da,result:d},d}function N(){var b="LF@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if("\n"===a.substr(da,1)){var d="\n";da+=1}else{var d=null;ea&&f('"\\n"')}return ha[b]={nextPos:da,result:d},d}function O(){var a="LWSP@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=[],d=S();if(null!==d)var e=d;else{var f=da,g=H();if(null!==g){var h=S();if(null!==h)var i=[g,h];else{var i=null;da=f}}else{var i=null;da=f}if(null!==i)var e=i;else var e=null}for(;null!==e;){c.push(e);var d=S();if(null!==d)var e=d;else{var f=da,g=H();if(null!==g){var h=S();if(null!==h)var i=[g,h];else{var i=null;da=f}}else{var i=null;da=f}if(null!==i)var e=i;else var e=null}}return ha[a]={nextPos:da,result:c},c}function P(){var b="OCTET@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if(null!==a.substr(da).match(/^[\0-\xFF]/)){var d=a.charAt(da);da++}else{var d=null;ea&&f("[\\0-\\xFF]")}return ha[b]={nextPos:da,result:d},d}function Q(){var b="SP@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if(" "===a.substr(da,1)){var d=" ";da+=1}else{var d=null;ea&&f('" "')}return ha[b]={nextPos:da,result:d},d}function R(){var b="VCHAR@"+da,c=ha[b];if(c)return da=c.nextPos,c.result;if(null!==a.substr(da).match(/^[!-~]/)){var d=a.charAt(da);da++}else{var d=null;ea&&f("[!-~]")}return ha[b]={nextPos:da,result:d},d}function S(){var a="WSP@"+da,b=ha[a];if(b)return da=b.nextPos,b.result;var c=Q();if(null!==c)var d=c;else{var e=M();if(null!==e)var d=e;else var d=null}return ha[a]={nextPos:da,result:d},d}function T(){function b(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(ga),d=Math.max(da,fa),f=d<a.length?e(a.charAt(d)):"end of input";return"Expected "+c+" but "+f+" found."}function U(){for(var b=1,c=1,d=!1,e=0;fa>e;e++){var f=a.charAt(e);"\n"===f?(d||b++,c=1,d=!1):"\r"===f|"\u2028"===f||"\u2029"===f?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}function V(a){for(var b=[],c=0;c<a.length;c++)"object"==typeof a[c]?b=b.concat(V(a[c])):b.push(a[c]);return b}function W(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function X(a){return{type:"text",val:a}}function Y(){return{type:"tag",name:"newpage"}}function Z(a){return{type:"tag",name:"chapter",title:a}}function $(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function _(a){return{type:"tag",name:"jump",pageNumber:a}}function aa(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}function ba(a,b){return{type:"tag",name:"rb",rubyBase:a,rubyText:b}}var ca={ALPHA:D,BIT:E,CHAR:F,CR:G,CRLF:H,CTL:I,DIGIT:J,DQUOTE:K,HEXDIG:L,HTAB:M,LF:N,LWSP:O,OCTET:P,SP:Q,URI:y,VCHAR:R,WSP:S,chapterTitle:u,inlineInlineText:l,inlineInlineToken:m,inlineInlineTokens:n,inlineText:i,inlineToken:j,inlineTokens:k,integer:x,jumpuriTitle:v,newLine:C,novel:g,numeric:w,percent_token:A,tag:o,tagChapter:q,tagJump:s,tagJumpuri:t,tagNewpage:p,tagPixivimage:r,tagRuby:B,text:h,uri_chrs:z};if(void 0!==b){if(void 0===ca[b])throw new Error("Invalid rule name: "+e(b)+".")}else b="novel";var da=0,ea=!0,fa=0,ga=[],ha={},ia=ca[b]();if(null===ia||da!==a.length){var ja=U();throw new this.SyntaxError(T(),ja.line,ja.column)}return ia},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}();b.exports=a}()},{}]},{},[1]);
//# sourceMappingURL=pixiv2aozora.min.js.map